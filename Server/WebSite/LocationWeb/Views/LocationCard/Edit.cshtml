@model DbModel.Location.AreaAndDev.LocationCard

@{
    ViewBag.Title = "Edit";
}

<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h2 class="modal-title" id="myModalLabel">Edit</h2>
</div>

<div class="modal-body">
    @using (@Ajax.BeginForm(new AjaxOptions() { HttpMethod = "Post", OnSuccess = "saveSuccess(data)" }))
    {
        @Html.AntiForgeryToken()

        <div class="form-horizontal">
            <h4>Tag</h4>
            <hr />
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            @Html.HiddenFor(model => model.Id)
            @Html.HiddenFor(model => model.Abutment_Id)

            <div class="form-group">
                @Html.LabelFor(model => model.Code, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.Code, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Code, "", new { @class = "text-danger" })
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.Describe, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.Describe, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Describe, "", new { @class = "text-danger" })
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Save" class="btn btn-default" />
                </div>
            </div>
        </div>

        <div>
            @Html.ActionLink("返 回", "Index")
        </div>
    }
</div>
    
    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
    }

    <link href="~/Content/toastr.css" rel="stylesheet" />
    <script src="~/Scripts/toastr.js"></script>

    <script src="~/Scripts/editmodal.js"></script>

    @*<script type="text/javascript">
                function saveSuccess(result) {
                    if (result.success) {
                        //参数设置，若用默认值可以省略以下面代
                        toastr.options = {
                            closeButton: false, //是否显示关闭按钮
                            debug: false, //是否使用debug模式
                            positionClass: "toast-top-full-width",//弹出窗的位置
                            showDuration: "300",//显示的动画时间
                            hideDuration: "1000",//消失的动画时间
                            timeOut: "2000", //展现时间
                            extendedTimeOut: "1000",//加长展示时间
                            showEasing: "swing",//显示时的动画缓冲方式
                            hideEasing: "linear",//消失时的动画缓冲方式
                            showMethod: "fadeIn",//显示时的动画方式
                            hideMethod: "fadeOut" //消失时的动画方式
                        };
                        toastr.success("修改成功！");
                        $('#myModal').modal('hide');

                        //局部刷新页面
                        $(function () {
                            $("#freshTable").load(location.href + " #freshTable");//注意后面DIV的ID前面的空格，很重要！（也可以使用类名）
                        })

                        //延时加载页面
                        //setTimeout(function () {
                        //    location.reload();
                        //}, 1000);

                        //location.reload();
                    } else {
                        $.each(result.errors, function (key, val) {
                            var container = $('span[data-valmsg-for="' + key + '"]');
                            container.removeClass("field-validation-valid").addClass("field-validation-error");
                            container.html(val[val.length - 1].ErrorMessage);
                        });
                    }
                }
                $(function () {
                    //allow validation framework to parse DOM
                    $.validator.unobtrusive.parse('form');
                });
    </script>*@

